import pandas as pd
import requests
from datetime import timedelta
from urllib.parse import urlparse
import os
from dotenv import load_dotenv


GITHUB_ACCESS_TOKEN = os.getenv("GITHUB_ACCESS_TOKEN")
HEADERS = {
    "Authorization": f"token {GITHUB_ACCESS_TOKEN}",
    "Accept": "application/vnd.github.v3+json"
}


# https://github.com/vcu-swim-lab/incivility-dataset/blob/main/dataset/issue_threads.csv
issue_threads_df = pd.read_csv('data/issue_threads.csv')
# https://github.com/vcu-swim-lab/incivility-dataset/blob/main/dataset/annotated_issue_level.csv
annotated_issue_level_df = pd.read_csv('data/annotated_issue_level.csv')

issue_threads_df['created_at'] = pd.to_datetime(issue_threads_df['created_at'])
annotated_issue_level_df['created_at'] = pd.to_datetime(annotated_issue_level_df['created_at'])

merged_df = pd.merge(issue_threads_df, annotated_issue_level_df, on='issue_id', suffixes=('_thread', '_toxic'))


